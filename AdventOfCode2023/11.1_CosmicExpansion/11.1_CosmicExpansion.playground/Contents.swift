import UIKit

class CosmicExpansion {
    
    var shortInput: String {
        let input =
        """
        ...#......
        .......#..
        #.........
        ..........
        ......#...
        .#........
        .........#
        ..........
        .......#..
        #...#.....
        """
        return input
    }
    var longInput: String {
        let input =
        """
        ...................#.....#...............#......................#......................#...................#...........................#....
        ..................................................#................................................#..............#.........................
        ......#.....#.................#..............................................................#..............................................
        ......................................................#..................#.....#............................................................
        .....................................................................................#.....................................#................
        .#............................................................................................................#.............................
        ..................#......................#............................#..............................................................#.....#
        ......................................................................................................#.............#.......................
        ..............................................#........#........................#................................................#..........
        .....#......................#......................................#.....#...................#..............................................
        .........................................................................................................#..................................
        ......................#...............#............#........................................................................................
        ..................................................................................................#.........................................
        ..........#..................................................................................................#..............#..........#....
        ....#...........................#..........................#..............................#.................................................
        ........................................#............................................#.................................#.........#..........
        ...................................................................#...........#..........................#.................................
        ............................................................................................................................................
        ............................................#...............................................................................................
        ....................#.................................#................................................................................#....
        ............................................................................................#...............................................
        ............................................................................#........#.........................................#............
        ...#...................#..........................#...............#......................................................#..................
        ..............................#........#....................................................................................................
        ................#................................................................................#.......................................#..
        ......#..............................................................#...................#..................................................
        .#.........................................#..........#.........#..............#........................#............#......................
        ............................................................................................................................................
        ...........#...................................#...............................................................#.............#..............
        ........................#........#........................................#..........#..................................................#...
        ....#.....................................................#.................................#......................................#........
        ...............................................................#...................................#....................#...................
        #.............................................................................#..................................#.............#............
        .............................#..........#.............................#...................................#.................................
        ........................................................#...................................................................................
        .............#........................................................................................................#................#....
        ...#.............................................#..................................#......#.....#..........................................
        ................................#..............................#............................................................................
        ...................#........................................................#...............................................................
        #..........................#.........................................................................#......#...........#...................
        .......#...........................#.....#..............#.................................................................................#.
        ......................#.........................#...........................................................................................
        .....................................................................................................................#.......#......#.......
        .............................................................#....................#...............#.........................................
        .........#..................................................................................................................................
        ...............................#............#....................#.....#...............#..................#.................................
        ....#...........#.........#.........................#..............................................................#..................#.....
        .....................#.......................................................................#..............................................
        ....................................................................................................#.......................................
        .....................................#..........#...............................#...........................#..........#..........#.......#.
        ..........................................................................................#.................................................
        .#..........................................#.............................#.................................................................
        .................#...........#............................#.............................................#......................#............
        .........#...........................................................#..............#.......................................................
        ..................................................................................................#.............#.......#...................
        .............................................................................#.......................................................#......
        ......#.............#...........#..........#........#...........#...........................................#...............................
        .........................................................................#..................................................................
        ........................................................#...........#...........#................................................#..........
        ........................................#....................#..........................................#.............#.....................
        ..........#...................#................................................................#..........................................#.
        ..................#.................................................................................#..........#............................
        ..........................................................................................#.................................................
        ..........................................................#...............#.................................................................
        ............#................................#......................#..........#.........................................#......#...........
        ..#.......................#..................................................................................#.....#........................
        .................................................#...........................................#..............................................
        .........#........#..................#...........................#.....................#...............#.............................#......
        ......................................................................#..........................#.....................#....................
        ............................................................................................................................................
        ........................#.....................................................................................#............#............#...
        ..............#............................#.................................#......#.......................................................
        ........#..........#........................................................................................................................
        ............................#............................................#..........................#.......................................
        .......................................................#......#.........................................................#......#............
        .........................................................................................#.....#..................#.........................
        .......................#................#.......................................#............................#.......................#......
        ............................................................................................................................................
        .........#.......................................................................................................................#..........
        ...#..........#................................#...........#......#.....................................................................#...
        ....................................................................................#.......................................................
        .............................#.....................................................................................#.....#..................
        ...................................#.....................................................#.............#....................................
        .....#.............#................................#......................................................................................#
        .............#............................................#...................#.................#.....................#.....#......#........
        #...............................#.........#..........................................#......................................................
        .........................#...............................................#..................................................................
        .................................................................................#......................................................#...
        ....#...........#..................................#......................................................#.................................
        ..............................................#.....................#.......................#...........................#...................
        ..............................#.........................#.............................................#.........#...........................
        .........................................#.....................................#...............................................#............
        .#.........#..................................................#..........................#...........................#......................
        ............................................................................................................................................
        .........................................................................................................................................#..
        .......#..........................................#.......................#................................................#........#.......
        ............................................................................................................................................
        .................#.........#.........................................#.........................#.....#......#...............................
        ............................................#..........#......................#......#......................................................
        ....................................#.............................................................................#.........................
        ...........................................................#................................................................................
        .................................................................................#........#...............#..............................#..
        .......#...........#..............................#.........................................................................................
        ..#...............................................................................................#.................#............#..........
        ..............................................#..........#...............#..................................................................
        ..................................#.....#.....................#.......................#...............#......#.............#................
        ..........................#.................................................................................................................
        ....................................................#..................................................................#....................
        ...........................................................................#..............#.....#...........................................
        #...................#...........................................................#...........................................................
        ...........................................#....................#....................................................................#......
        .......#.....#........................................#....................................................#................................
        ..............................#...................................................................#.........................................
        .............................................................................#.......................................#......................
        .....................#....................................................................................................................#.
        .................................#....................................#........................#............................................
        ......#...........................................#.........................................................................................
        ...........................................#................................................................................#......#........
        ..........#...............#.........................................................#.......................................................
        ..................#...........................................................#.............................................................
        ...............................................................#............................................#.......#.......................
        ....#........#...................................................................................#..........................................
        ......................#...................................................#...........#................#....................................
        ........#..............................................#...................................#....................#...........................
        ..................................................#.......................................................................#..........#......
        .#...................................#..........................................................................................#...........
        ..........................................#........................................#...............#........................................
        ..........................#.....#........................................................................................................#..
        ..................#...........................#..........#...........................................................#......................
        ...................................................#......................#...................................................#.............
        .........#................................................................................#.................................................
        ..............#................................................................#............................................................
        ...........................#.........#..............................#...................................#..........#....................#...
        ..................................................................................................#.............................#...........
        ..#..............................................#..........................................................................................
        .................#.....................................................#.................#..................................................
        .................................#.........#...................................................#......#.........#...........................
        ..........#.........................................#.....#......................#..........................................................
        ....................#..........................#................#...........................................................#......#........
        #........................#.............#..................................#.................................#...............................
        """
        return input
    }
    
    func sumOfShortestWays(input: String) -> Int {
        var sum: Int = 0
        
        //
        var lines: [String] = input.components(separatedBy: "\n")
        var grid: [[Character]] = []
        
        // MARK: - Get Grid with doubled empty Rows
        
        var emptyColumnsIndices: [Int] = Array<Int>(0...(lines[0].count - 1))
                
        for line in lines {
            let row = Array(line)
            if row.contains("#") {
                grid.append(row)
                for i in 0...(row.count - 1) {
                    if row[i] == "#" && emptyColumnsIndices.contains(i) {
                        emptyColumnsIndices.removeAll { $0 == i }
                    }
                }
            } else {
                for _ in 1...2 {
                    grid.append(row)
                }
            }
            
        }
        
        // MARK: - Get the real Grid
        
        var realGrid: [[Character]] = []
        
        for row in grid {
            var newRow = row
            for (offset, emptyColumnIndex) in emptyColumnsIndices.enumerated(){
                newRow.insert(".", at: emptyColumnIndex + 1 + offset)
            }
            realGrid.append(newRow)
        }
        
        // MARK: - Indices of all the "#"-characters
        var allGalaxies: [[Int]] = []
        
        for (rowIndex, row) in realGrid.enumerated() {
            for (columnIndex, column) in row.enumerated() {
                if column == "#" {
                    var galaxyIndices: [Int] = []
                    galaxyIndices.append(rowIndex)
                    galaxyIndices.append(columnIndex)
                    allGalaxies.append(galaxyIndices)
                }
            }
        }
                
        print(allGalaxies.count)
        
        for (galaxyNumber, galaxyIndices) in allGalaxies.enumerated() {
            guard galaxyNumber != (allGalaxies.count - 1) else { break }
            
            for nextGalaxyNumber in allGalaxies[(galaxyNumber + 1)...(allGalaxies.count - 1)] {
                var horizontalyFar: Int = abs(nextGalaxyNumber[0] - galaxyIndices[0])
                var verticalyFar: Int = abs(nextGalaxyNumber[1] - galaxyIndices[1])
                
                var length: Int = horizontalyFar + verticalyFar
                sum += length
            }
        }
        
        return sum
    }
}

//CosmicExpansion().sumOfShortestWays(input: CosmicExpansion().shortInput) // Right answer: 374
CosmicExpansion().sumOfShortestWays(input: CosmicExpansion().longInput) // Right answer: 10077850
